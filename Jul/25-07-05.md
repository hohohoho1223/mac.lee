# 오늘 내가 배운 것들(Today I Learned)

- vLLM 적용후 챗봇 (/base-info) 답변 호출 받았는데

![Image.png](https://resv2.craft.do/user/full/641ffdb9-6693-37da-6dbd-e78e1756c2de/doc/3c17d71c-25ef-2249-36c5-6ac2c9747d25/F86A5A39-5040-40F4-840D-D7236D126207_2/nuFOdymb7BHCsnPIqiAxUIalYBTxs6bGbzT8lFl5xKIz/Image.png)

- 이전 vLLM 적용 전에는 단어 별로 토큰화 돼서 출력 됐는데, 적용 하고 나니 한글자씩 출력되는 현상이 생겼다.

### WHY? 

- 이전 shared_model 방식: Transformers의 TextIteratorStreamer를 사용해서 단어 단위로 토큰화되어 스트리밍됨
- 현재 vLLM 방식: vLLM의 스트리밍 API를 사용해서 한 글자씩 토큰화되어 스트리밍됨

### 이게 왜 문제가 되나?

- FE에서 SSE 스트리밍을 받을때, 토큰별로 띄어쓰기가 되는데, 기존 단어별로 띄어쓰기가 되는 대신 지금은 띄어쓰기가 없이 바로 한문장 처럼 나타나게 된다.

### 해결 방법?

- vLLM 서버를 실행할 때 --streaming-mode 옵션을 사용해서 토큰 단위 스트리밍으로 변경하거나, 클라이언트에서 토큰을 누적해서 단어 단위로 보내도록 수정해야 함
- `troubleshooting` 에 “[vLLM 스트리밍 단어별 토큰](https://github.com/100-hours-a-week/15-Leafresh-AI/commit/225f765b910f1e2f1a8088579fe4527740958984)" 커밋으로 남김.