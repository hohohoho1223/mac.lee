# 오늘 내가 배운 것들(Today I Learned)

- 프로젝트 진행중 챗봇에 대한 예외처리 작업하다가 오류 코드 설계 기준 및 종류가 궁금해졌다.

---

| **상태 코드**                | **의미**            | **예시**               |
| ------------------------ | ----------------- | -------------------- |
| 400 Bad Request          | 클라이언트 요청이 잘못되었을 때 | 파라미터 누락, 잘못된 주제 요청 등 |
| 401 Unauthorized         | 인증이 필요할 때         | 로그인 필요               |
| 403 Forbidden            | 권한은 있지만 접근이 금지    | 비회원 전용 챌린지           |
| 404 Not Found            | 자원이 없을 때          | 존재하지 않는 챌린지 ID       |
| 422 Unprocessable Entity | 문법은 맞지만 의미 파악 불가  |                      |

- 그리고 응답 JSON내부에 status 필드를 넣어야 하는지에 대해 의문이 생겼다
- 몰론 필요한 경우도 있고 불필요한 경우도 있다.
    - `비동기 처리`  또는 `지연 처리` 에서 HTTP200과 JSON 내부 상태 코드를 분리해ㅔ서 사용하는 상황이 있기에!
    - 프론트앤드에서 요청을 보냄 → 서버는 **비동기로 작업 큐에 넣는다** → 사용자는 "요청을 정상적으로 받았다"는 의미로 **HTTP 200**을 먼저 보냄 → BUT, 실제 처리는 아직 완료하지 않음!
    

| **케이스**                  | **JSON 내부 status 필요 여부**                   |
| ------------------------ | ------------------------------------------ |
| 단순 요청/응답 (즉시 처리)         | 필요 없음 (HTTP 코드로 충분)                        |
| **비동기 처리** (지연 응답, 큐 기반) | 필요함 (PENDING, PROCESSING, SUCCESS, FAILED) |
| 다양한 상태를 클라이언트가 분기해야 할 때  | 필요함 (status 또는 code)                       |

- “다양한 상태를 클라이언트가 분기해야 할 때"
    -  클라이언트가 JOSN내부의 status 값을 기준으로 서로 다른 UI/로직을 수행해야 하는 경우
    - HTTP 상태코드만으로는 부족해서 JSON 내부의 status 값을 의미단위로 분기해야핧 때임!

###  예시상황 : 챌린지 인증 시스템

-  서버 응답

```json
{
  "status": "ALREADY_VERIFIED",
  "message": "이미 오늘 인증을 완료하셨어요!",
  "data": null
}
```

- 클라이언트 분기 처리 예시

| **JSON status**  | **프론트 행동**                 |
| ---------------- | -------------------------- |
| SUCCESS          | ✅ 인증 완료 화면 보여주기            |
| PENDING_REVIEW   | ⏳ “AI가 인증을 검토 중입니다” 안내     |
| ALREADY_VERIFIED | 🔁 “오늘 이미 인증 완료됨” 팝업       |
| FAILED           | ❌ “사진 인식 실패” → 다시 시도 버튼 표시 |